/*! Validatr - v0.1.2 - 2013-02-12
* https://github.com/jaymorrow/validatr
* Copyright (c) 2013 Jay Morrow; Licensed MIT */
(function(e,t,n,r){"use strict";function m(e,t){this.el=e,this.$el=n(e);if(!this.$el.length||!this.$el.is("form"))throw new Error(c+" needs a form to work.");this.isSubmit=!1,this.firstError=!1,this.options=n.extend({},n.fn[c].defualtOptions,t),this.options.template=n(this.options.template).addClass(h.base+h[this.options.theme])[0].outerHTML,this.elements=this.getElements(this.el).on("valid."+c,n.proxy(k,this)).on("invalid."+c,n.proxy(C,this)),this.el.noValidate=!0,this.$el.on("submit."+c,n.proxy(x,this)),this.$el.on("reset."+c,n.proxy(T,this))}function g(){this.elements.on({"focus.validatrelement":b,"blur.validatrelement":w}),n("input[type=radio]").on("click.validatrelement",function(e){E(e.target)})}function y(){this.elements.off(".validatrelement")}function b(e){var t=e.target;n(t).on({"change.validatrinput":function(){setTimeout(function(){E(t)},1)},"blur.validatrinput":function(){E(t)},"keyup.validatrinput":function(){t.value.length&&E(t)}})}function w(e){n(e.target).off(".validatrinput")}function E(e){if(e.type==="radio"){var r=n(t.getElementsByName(e.name)).filter("[required]");r.length&&(e=r[0])}var a=n(e),f=e.getAttribute("type"),l=i.required?e.required:N(e),c={valid:!0};if(i.inputtypes[f]&&e.checkValidity){c.valid=e.checkValidity();if(!c.valid)return!1}else l&&(c=o.required(e)),c.valid&&e.value.length&&!s.boxes.test(f)&&(e.pattern&&(f="pattern"),o[f]&&(c=o[f](e)));if(c.valid)for(var h in u)if(u.hasOwnProperty(h)&&a.data(h)){c=u[h](e);if(!c.valid)break}return c.valid?(a.trigger("valid"),!0):(n.data(e,"validationMessage",c.message),a.trigger("invalid"),!1)}function S(e){var t=!0;return e.each(function(e,n){E(n)||(t=!1)}),t}function x(){this.isSubmit=!0,T.call(this);var e=S(this.elements);return e?this.options.valid.call(this.el,this.el):(g.call(this),this.isSubmit=!1,e)}function T(){y.call(this),this.firstError=!1,this.$el.find(".validatr-message").remove()}function N(e){if(e.required)return e.required==="true";var t=e.attributes,n=t.length,r=0;for(r;r<n;r+=1)if(t[r].name==="required")return e.required="true",!0;return e.required="false",!1}function C(e){if(d)return;e.preventDefault();var t=e.target,r=n(t),i=t.validationMessage||n.data(t,"validationMessage"),s=this.options,o=n(s.template.replace("{{message}}",i));if(this.isSubmit&&!this.firstError){this.firstError=r.after(o),s.position.call(this,o,r);return}if(!this.isSubmit||s.showall)k(e),r.after(o),s.position.call(this,o,r)}function k(e){n(e.target).next(".validatr-message").remove()}function L(e,t){e.css("position","absolute");var n=t.offset(),r=t.data("location")||this.options.location;s.topbottom.test(r)?(e.offset({left:n.left}),r==="top"&&e.offset({top:n.top-e.outerHeight()-2}),r==="bottom"&&e.offset({top:n.top+e.outerHeight()})):s.leftright.test(r)&&(e.offset({top:n.top+t.outerHeight()/2-e.outerHeight()/2}),r==="left"&&e.offset({left:n.left-e.outerWidth()-2}),r==="right"&&e.offset({left:n.left+t.outerWidth()+2}))}var i=function(){var e={},n=t.documentElement,i=":)",s=t.createElement("input"),o={};return e.required="required"in s,e.inputtypes=function(e){for(var u=0,a,f,l,c=e.length;u<c;u++)s.setAttribute("type",f=e[u]),a=s.type!=="text",a&&(s.value=i,s.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&s.style.WebkitAppearance!==r?(n.appendChild(s),l=t.defaultView,a=l.getComputedStyle&&l.getComputedStyle(s,null).WebkitAppearance!=="textfield"&&s.offsetHeight!==0,n.removeChild(s)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?a=s.checkValidity&&s.checkValidity()===!1:a=s.value!==i)),o[e[u]]=!!a;return o.text=!0,o.password=!0,o}("search tel url email datetime date month week time datetime-local number range color".split(" ")),s=null,e}(),s={boxes:/checkbox|radio/i,color:/^#[0-9A-F]{6}$/i,email:/^[a-zA-Z0-9.!#$%&â€™*+\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*$/,isoDate:/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/,leftright:/left|right/i,time:/^([01][0-9]|2[0-3])(:([0-5][0-9])){2}$/,topbottom:/top|bottom/i,url:/^\s*https?:\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?\s*$/},o={checkbox:function(e){return{valid:e.checked,message:"Please check this box if you want to proceed."}},color:function(e){return{valid:s.color.test(e.value),message:"Please enter a color in the format #xxxxxx"}},date:function(e){var t=n(e),r=a(e.value),i=t.attr("min")?a(t.attr("min")):!1,s=t.attr("max")?a(t.attr("max")):!1,o=isNaN(t.attr("step"))?!1:parseInt(t.attr("step"),10);return f(r,i,s,o,"date")},email:function(e){var t=!0,r="Please enter an email address.";if(e.multiple){var i=e.value.split(",");n.each(i,function(e,n){if(!s.email.test(n)){t=!1,r="Please enter a comma separated list of email addresses.";return}})}else t=s.email.test(e.value);return{valid:t,message:r}},number:function(e){var t=n(e),r=isNaN(parseFloat(e.value))?!1:parseFloat(e.value),i=r!==!1?isNaN(t.attr("min"))?!1:parseFloat(t.attr("min")):!1,s=r!==!1?isNaN(t.attr("max"))?!1:parseFloat(t.attr("max")):!1,o=r!==!1?isNaN(t.attr("step"))?!1:parseFloat(t.attr("step")):!1;return o!==!1&&i===!1&&(i=0),f(r,i,s,o,"number")},pattern:function(e){return{valid:(new RegExp(e.pattern)).test(e.value),message:"Please match the requested format."}},radio:function(e){return{valid:n(t.getElementsByName(e.name)).is(":checked"),message:"Please select one of these options."}},range:function(e){return this.number(e)},required:function(e){return s.boxes.test(e.type)?this[e.type](e):{valid:e.value.length,message:e.nodeName.toLowerCase()==="select"?"Please select an item in the list.":"Please fill out this field."}},time:function(e){return{valid:s.time.test(e.value),message:"Please enter a time in the format hh:mm:ss"}},url:function(e){return{valid:s.url.test(e.value),message:"Please enter a url."}}},u={match:function(e){var r=n(e).data("match"),i=t.getElementById(r)||t.getElementsByName(r)[0];return i?(n(i).off("valid.validatrinput").on("valid.validatrinput",function(){e.value===i.value&&E(e)}),{valid:e.value===i.value,message:"'"+e.name+"' does not equal '"+i.name+"'"}):{valid:!1,message:"'"+r+"' can not be found"}}},a=function(e){if(!s.isoDate.test(e))return!1;var t=s.isoDate.exec(e);return new Date(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10))},f=function(e,t,n,r,i){var s=!0,o="Please enter a "+i;return e!==!1&&(t!==!1&&n!==!1?(s=e>=t&&e<=n,o="Please enter a "+i+" greater than or equal to "+t+" and less than or equal to "+n+"."):t!==!1?(s=e>=t,o="Please enter a "+i+" greater than or equal to "+t+"."):n!==!1&&(s=e<=n,o="Please enter a "+i+" less than or equal to "+n+"."),s&&r!==!1&&(s=(e-t)%r===0,o="Invalid "+i)),{valid:e!==!1&&s,message:o}},l=function(e){return e instanceof jQuery&&(e=e[0]),e},c="validatr",h={base:c+"-message ",bootstrap:"alert alert-error",jqueryui:"ui-state-error ui-corner-all",none:c+"-error"},p="button, input[type=submit], input[type=button], input[type=reset]",d=!1,v=function(){};v.prototype={addTest:function(e){var t=typeof e!="string",r=Array.prototype.slice.call(arguments,1)[0];t?n.extend(u,e):u[e]=r},getElements:function(e){return this.elements?this.elements:n(e).map(function(){return this.elements?n.makeArray(this.elements):n.makeArray(n(this).find("input, textarea, select"))}).not(p)},validateElement:function(e){if(!e)throw new Error("method requires an element");d=!0;var t=E(l(e));return d=!1,t},validateForm:function(e){var t=this.el||l(e),n;if(t.nodeName.toLowerCase()!=="form")throw new Error("you must pass a form to this method");return d=!0,n=S(this.elements||this.getElements(t)),d=!1,n}},n.fn[c]=function(e){var t=typeof e=="string",i=Array.prototype.slice.call(arguments,1),s=this,o;if(t)this.each(function(){var t;o=n.data(this,c);if(!o)throw new Error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+e+"'");if(!n.isFunction(o[e]))throw new Error("no such method '"+e+"' for "+c+" widget instance");t=o[e].apply(o,i);if(t!==o&&t!==r)return s=t&&t.jquery?s.pushStack(t.get()):t,!1});else{var u;this.each(function(){o=n.data(this,c),o||(u=new v,m.call(u,this,e||{}),n.data(this,c,u))})}return s},n.fn[c].defualtOptions={showall:!1,location:"right",position:L,template:"<div>{{message}}</div>",theme:"none",valid:n.noop},n[c]=new v,n.expr[":"][c]=function(e){return e.textContent.indexOf(c)>=0}})(this,this.document,jQuery);